<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>For My Love üíñ</title>
<style>
body {
  margin: 0;
  font-family: 'Segoe Script', cursive;
  background: linear-gradient(#fff0f6, #ffe4f1);
  color: #d63384;
  text-align: center;
  overflow-x: hidden;
  overflow-y: auto;
}
.hidden { display: none; }
.fade { opacity:0; animation: fadeIn 1s forwards; }
@keyframes fadeIn { from{opacity:0} to{opacity:1;} }

img { width: 180px; margin: 10px; border-radius: 20px; box-shadow:0 4px 15px rgba(0,0,0,0.2); transition: transform 0.3s ease; }
img:hover { transform: scale(1.05); }

button { padding: 12px 24px; margin: 20px; font-size: 18px; border:none; border-radius:25px; background:#ff4d6d; color:white; cursor:pointer; transition:0.3s; }
button:hover { background:#e03159; transform: scale(1.05); }

.gift { font-size:80px; cursor:pointer; margin:30px; animation:shake 1s infinite alternate; }
@keyframes shake {0% {transform:rotate(-5deg);} 100%{transform:rotate(5deg);} }

video { width:60%; max-width:500px; border-radius:20px; box-shadow:0 4px 15px rgba(0,0,0,0.3); }

.heart { position: fixed; bottom:-50px; font-size:24px; animation:float 5s linear infinite; color:#ff4d6d; text-shadow:0 0 5px #ff85c1,0 0 10px #ff4d6d;}
@keyframes float { from{transform:translateY(0);opacity:1;} to{transform:translateY(-100vh);opacity:0;} }

.easter-egg { position: fixed; bottom:10px; right:10px; font-size:25px; cursor:pointer; opacity:0.7; transition:0.2s;}
.easter-egg:hover { transform:scale(1.2); }

/* Letter Styles */
.letter-wrapper {
  position: relative;
  width: 80%;
  max-width: 700px;
  height: 500px;
  margin: 20px auto;
  perspective: 1000px;
}
.ribbon {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  font-size: 50px;
  cursor: pointer;
  z-index: 10;
  transition: top 0.5s ease, opacity 0.5s ease;
}
.letter-content {
  background: #fff8e7;
  width: 100%;
  height: 100%;
  border-radius: 15px;
  box-shadow:0 4px 15px rgba(0,0,0,0.2);
  padding: 30px;
  font-family: 'Handlee', cursive;
  font-size: 22px;
  color: #333;
  overflow: hidden;
  transform-origin: top;
  transform: scaleY(0);
  transition: transform 0.5s ease;
  touch-action: none;
}
.letter-content.open { transform: scaleY(1); overflow-y:auto; }

/* Game Styles */
#stageGame { height: 500px; position: relative; }
#gameCanvas { background: #ffe4f1; border-radius: 15px; margin: 20px auto; display:block; box-shadow: 0 0 20px rgba(255,0,100,0.4); }
#scoreDisplay {
  position: absolute;
  top: 10px;
  right: 20px;
  font-size: 22px;
  background: rgba(255,255,255,0.8);
  padding: 8px 15px;
  border-radius: 20px;
  box-shadow:0 4px 15px rgba(0,0,0,0.2);
  color: #d63384;
  font-weight: bold;
}
#targetDisplay {
  position: absolute;
  top: 10px;
  left: 20px;
  font-size: 22px;
  background: rgba(255,255,255,0.8);
  padding: 8px 15px;
  border-radius: 20px;
  box-shadow:0 4px 15px rgba(0,0,0,0.2);
  color: #d63384;
  font-weight: bold;
}
#trophy {
  position: absolute;
  top: 50px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 80px;
  cursor: pointer;
  animation: sparkle 1.5s infinite alternate;
  z-index: 10;
}
@keyframes sparkle {
  0% {text-shadow: 0 0 10px #ffd700,0 0 20px #ff85c1,0 0 30px #ff4d6d;}
  100% {text-shadow: 0 0 20px #ffd700,0 0 40px #ff85c1,0 0 60px #ff4d6d;}
}
</style>
</head>
<body>

<!-- Stages 1‚Äì6 remain same (omitted here for brevity, same as your previous code) -->

<!-- Stage 7: Game -->
<div id="stageGame" class="hidden fade">
<h2>üéÆ Catch the Hearts! üéÆ</h2>
<canvas id="gameCanvas" width="500" height="400"></canvas>
<div id="scoreDisplay">Score: 0</div>
<div id="targetDisplay">Target: 69</div>
<button onclick="goStage(1)">Restart üíñ</button>
</div>

<!-- Background Piano Music -->
<audio id="bgMusic" autoplay loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_15c8a8a5c3.mp3?filename=romantic-piano-112199.mp3" type="audio/mp3">
</audio>

<!-- Easter Egg -->
<div class="easter-egg" onclick="bonus()">‚ù§Ô∏è</div>

<script>
let giftTaps=0;
const bgMusic=document.getElementById('bgMusic');
bgMusic.volume=0.5;

function goStage(n){
  document.querySelectorAll("div[id^='stage']").forEach(d=>d.classList.add("hidden"));
  document.getElementById('stage'+n).classList.remove("hidden");
}

function openGift(){
  giftTaps++;
  if(giftTaps>=5) goStage(3);
}

function rainKisses(){
  for(let i=0;i<15;i++){
    let heart=document.createElement("div");
    heart.className="heart";
    heart.style.left=Math.random()*100+"vw";
    heart.style.animationDuration=(3+Math.random()*2)+"s";
    heart.innerHTML="üíã";
    document.body.appendChild(heart);
    setTimeout(()=>heart.remove(),5000);
  }
}

function bonus(){
  alert("üíñ I love you my D-I-V-A, Ummahh üòò");
}

// Ribbon & unrolling letter
function removeRibbon(){
  const ribbon=document.getElementById('ribbon');
  ribbon.style.top='-100px';
  ribbon.style.opacity='0';
  const letter=document.getElementById('letter');
  letter.classList.add('open');
}

// Drag to scroll letter
const letter=document.getElementById('letter');
let isDragging=false;
let startY, scrollStart;
letter.addEventListener('pointerdown', e=>{
  isDragging=true;
  startY=e.clientY || e.touches[0].clientY;
  scrollStart=letter.scrollTop;
  letter.setPointerCapture(e.pointerId);
});
letter.addEventListener('pointermove', e=>{
  if(!isDragging) return;
  const y=(e.clientY || e.touches[0].clientY);
  const dy=startY-y;
  letter.scrollTop=scrollStart+dy;
});
letter.addEventListener('pointerup', e=>{
  isDragging=false;
  letter.releasePointerCapture(e.pointerId);
});

// Magical Game
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
let hearts=[];
let score=0;
const goal=69;
let trophyShown=false;
let gameOver=false;
let player={x:canvas.width/2, y:canvas.height-20, width:50, height:20};
const scoreDisplay=document.getElementById('scoreDisplay');
const targetDisplay=document.getElementById('targetDisplay');
let sparkles=[];

// Sparkle effect
function createSparkle(x, y){
  sparkles.push({
    x:x+Math.random()*20-10,
    y:y+Math.random()*20-10,
    radius:2+Math.random()*2,
    alpha:1,
    speedY:0.5+Math.random()
  });
}

function drawSparkles(){
  sparkles.forEach((s,i)=>{
    ctx.beginPath();
    ctx.arc(s.x, s.y, s.radius,0,Math.PI*2);
    ctx.fillStyle='rgba(255,255,0,'+s.alpha+')';
    ctx.fill();
    s.y -= s.speedY;
    s.alpha -=0.02;
    if(s.alpha<=0){ sparkles.splice(i,1); }
  });
}

function spawnHeart(){
  if(gameOver) return;
  hearts.push({x:Math.random()*(canvas.width-20), y:0, size:20+Math.random()*10, speed:2+Math.random()*2});
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // player
  ctx.fillStyle='pink';
  ctx.fillRect(player.x,player.y,player.width,player.height);
  // player sparkles
  createSparkle(player.x+player.width/2, player.y);

  // hearts
  ctx.font='24px Arial';
  hearts.forEach((h,j)=>{
    ctx.fillText('‚ù§Ô∏è', h.x, h.y);
    createSparkle(h.x+10, h.y+10); // sparkles around heart
    h.y+=h.speed;
    if(!gameOver && h.y+20>player.y && h.y<player.y+player.height && h.x+10>player.x && h.x<player.x+player.width){
      score++;
      h.y=-50;
      if(score>=goal && !trophyShown){ showTrophy(); gameOver=true; }
    }
  });

  // sparkles
  drawSparkles();

  // update score display
  scoreDisplay.textContent='Score: '+score;

  requestAnimationFrame(draw);
}

function showTrophy(){
  trophyShown=true;
  const trophy=document.createElement('div');
  trophy.id='trophy';
  trophy.textContent='üèÜ';
  document.getElementById('stageGame').appendChild(trophy);

  trophy.addEventListener('click', ()=>{
    trophy.textContent='I love you endlessly üíñ';
    trophy.style.fontSize='36px';
    trophy.style.color='#ff4d6d';
  });
}

// player movement
canvas.addEventListener('mousemove', e=>{
  const rect=canvas.getBoundingClientRect();
  player.x=e.clientX-rect.left-player.width/2;
});
canvas.addEventListener('touchmove', e=>{
  e.preventDefault();
  const rect=canvas.getBoundingClientRect();
  player.x=e.touches[0].clientX-rect.left-player.width/2;
});

setInterval(spawnHeart,1000);
draw();
</script>
</body>
</html>
